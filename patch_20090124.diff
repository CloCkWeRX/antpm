19c19
< char *releasetime = "Jan 21 2008, 12:00:00";
---
> char *releasetime = "Jan 24 2009, 16:10:12";
464,467c464,466
< 				if (cad != 255) {
< 					if (sporttyp_track[track_id-firsttrack_id] == 0) {
< 						fprintf(tcxfile, "        <RunCadence>%d</RunCadence>\n", cad);
< 					} else {
---
> 				// for bike the average cadence of this lap is here
> 				if (sporttyp_track[track_id-firsttrack_id] == 1) {
> 					if (cad != 255) {
480a480,489
> 				// I prefere the average run cadence here than at the end of this lap according windows ANTagent
> 				if (sporttyp_track[track_id-firsttrack_id] == 0) {
> 					if (cad != 255) {
> 						fprintf(tcxfile, "        <Extensions>\n");
> 						fprintf(tcxfile, "          <LX xmlns=\"http://www.garmin.com/xmlschemas/ActivityExtension/v2\">\n");
> 						fprintf(tcxfile, "            <AvgRunCadence>%d</AvgRunCadence>\n", cad);
> 						fprintf(tcxfile, "          </LX>\n");
> 						fprintf(tcxfile, "        </Extensions>\n");
> 					}
> 				}
483d491
< 				track_pause = 0;
490,493d497
< 			} // end of if (tv >= tv_lap && lap <= lastlap)
< 			if (track_pause) {
< 				fprintf(tcxfile, "        </Track>\n");
< 				fprintf(tcxfile, "        <Track>\n");
495,496c499
< 				if (dbg) printf("track pause (stop and go)\n");
< 			}
---
> 			} // end of if (tv >= tv_lap && lap <= lastlap)
511a515,519
> 			// track pause only if following trackpoint is aswell 'timemarker' with utopic distance
> 			if (track_pause && dist > (float)40000000) {
> 				fprintf(tcxfile, "        </Track>\n");
> 				fprintf(tcxfile, "        <Track>\n");
> 			}
532,533c540,544
< 			if (u1 > 0 && cad != 255) {
< 				fprintf(tcxfile, "            <Cadence>%d</Cadence>\n", cad);
---
> 			// for bikes the cadence is written here and for the footpod in <Extensions>, why garmin?
> 			if (sporttyp_track[track_id-firsttrack_id] == 1) {
> 				if (cad != 255) {
> 					fprintf(tcxfile, "            <Cadence>%d</Cadence>\n", cad);
> 				}
540,548c551,552
< 				switch(sporttyp_track[track_id-firsttrack_id]) {
< 					case 1: fprintf(tcxfile, "Bike\""); break;
< 					case 0:
< 					default: fprintf(tcxfile, "Footpod\""); break;
< 				}
< 				if (u1 == 0 && cad != 255) {
< 					fprintf(tcxfile, ">\n");
< 					fprintf(tcxfile, "                <RunCadence>%d</RunCadence>\n", cad);
< 					fprintf(tcxfile, "              </TPX>\n");
---
> 				if (sporttyp_track[track_id-firsttrack_id] == 1) {
> 					fprintf(tcxfile, "Bike\"/>\n");
550c554,561
< 					fprintf(tcxfile, "/>\n");
---
> 					fprintf(tcxfile, "Footpod\"");
> 					if (cad != 255) {
> 						fprintf(tcxfile, ">\n");
> 						fprintf(tcxfile, "                <RunCadence>%d</RunCadence>\n", cad);
> 						fprintf(tcxfile, "              </TPX>\n");
> 					} else {
> 						fprintf(tcxfile, "/>\n");
> 					}
553,556c564
< 			} else {
< 				// maybe if we recieve utopic position and distance this tells pause in the run (stop and go)
< 				if (track_pause == 0) track_pause = 1;
< 				else                  track_pause = 0;
---
> 				track_pause = 0;
558a567,573
> 			// maybe if we recieve utopic position and distance this tells pause in the run (stop and go) if not begin or end of lap
> 			if (dist > (float)40000000 && track_pause == 0) {
> 				track_pause = 1;
> 				if (dbg) printf("track pause (stop and go)\n");
> 			} else {
> 				track_pause = 0;
> 			}
